<div
  class="map"
  [class.-disabled]="isLoading$ | async"
>
  <div id="station-popup-dismiss"
    *ngIf="(selectedStation$ | async)"
    (click)="unselectStation()">
  </div>
  <agm-map
    [latitude]="(currentPosition$ | async)?.lat || defaultCoord.lat"
    [zoom]="zoom"
    [longitude]="(currentPosition$ | async)?.lng || defaultCoord.lng"
    [streetViewControl]="false"
    (idle)="idle()"
    (boundsChange)="boundsChange($event)"
  >
    <agm-marker
      *ngFor="let marker of markers$ | async; trackBy: trackByFn"
      [latitude]="marker.lat"
      [longitude]="marker.lng"
      (markerClick)="clickedMarker(marker.id)"
      [opacity]="1"
      [iconUrl]="'/assets/directions_bike.svg'"
      [class.-selected]="(selectedStation$ | async)?.stationId === marker.id"
    >
    </agm-marker>
    <agm-marker
      *ngIf="!!(currentPosition$ | async)"
      [latitude]="(currentPosition$ | async)?.lat"
      [longitude]="(currentPosition$ | async)?.lng"
      [opacity]="1"
      [iconUrl]="'/assets/my_location.svg'"
    >
    </agm-marker>
    <agm-direction
      *ngIf="!!(currentPosition$ | async) && (destination$ | async)"
      [origin]="currentPosition$ | async"
      [destination]="destination$ | async"
      [travelMode]="travelMode"
    >
    </agm-direction>
  </agm-map>
  <app-speed-dial-fab
    *ngIf="!!(currentPosition$ | async) && !isDisplayingListPages"
    (redirect)="navigateTo($event)"
    [mainButtonIcon]="'navigation'"
    [fabButtons]="fabButtons"
  ></app-speed-dial-fab>
</div>
<app-loading *ngIf="isLoading$ | async"></app-loading>
